{% extends 'AppBundle::RapportSektioner/base.html.twig' %}
{% macro header(key) %}
  {% set calculation = key|get_calculation %}

  <th class="rotate">
    <div>
      {% if calculation is null %}
        <span>{{ key | trans }}</span>
      {% else %}
        <span data-calculation="{{ calculation }}">{{ key | trans }}</span>
      {% endif %}
    </div>
  </th>
{% endmacro %}

{% macro header_unit(key, border_right=false) %}
  {% set translation = key|get_unit %}
  {% set border = border_right ? 'border-right' : '' %}

  <th class="unit {{ border }}">
    {{ translation }}
  </th>
{% endmacro %}

{% macro header_span(key, span) %}
  {% set translation = key|trans %}

  <th colspan="{{ span }}" class="text-center border-right">
    {{ translation }}
  </th>
{% endmacro %}

{% import _self as helper %}

{% set sectionTypeNavn = (('rapportsektion.types.' ~ section.type ) | trans) ~ ' ' ~ section.number ~ '. ' ~ (('bygning_rapporter.strings.' ~ section.tiltagType ~ 'tiltag') | trans) %}
{% block section -%}
  {{ block('section_type') }}
  <div class="section-light-green">
    {% if section.filepath %}
      <div class="section-tiltag-image">
        <img src="{{ absolute_url(asset(section.filepath)) }}" alt=""/>
      </div>
    {% endif %}
    <div class="section-tiltag-effect">
      <div class="section-tiltag-effect-title">Effekt:</div>
      <div class="row">
        <div class="col-xs-4">
          <span class="enlarged">{{ section.potentieltBesparesleCo2 | format_decimal }} <small>tons CO2</small></span>
          <span>sparet årligt</span>
        </div>
        <div class="col-xs-4">
          <span class="enlarged">{{ section.potentieltBesparesleKr | format_decimal(0) }} <small>kr.</small></span>
          <span>sparet årligt</span>
        </div>
        <div class="col-xs-4">
          <span class="enlarged">{{ section.potentieltBesparesleKwh | format_decimal(0) }} <small>kWh</small></span>
          <span>sparet årligt</span>
        </div>
      </div>
    </div>
  </div>

  {% block section_title -%}
    {% if section.sectionTitle %}
      <h1> {{ section.number }}. {{ section.sectionTitle }}</h1>
    {% endif %}
  {% endblock %}
  {% block section_content -%}
    {% if section.text %}
      <div class="section-text">
        {{ section.text | raw }}
      </div>
    {% endif %}
  {% endblock %}

  {% include 'AppBundle::RapportSektioner/_includes/section-page-break.html.twig' %}
  <div class="section-tiltag-details">
    <h2>Forslagsdetaljer</h2>
    <h3>{{ 'common.result_overview' | trans }}</h3>
    <div class="row">
      <div class="col-xs-8">{{ 'appbundle.tiltag.varmebesparelseGUF' | trans }}</div>
      <div class="col-xs-2 text-right">{{ section.tiltag.varmebesparelseGUF | format_zeros }}</div>
      <div class="col-xs-2">{{ 'appbundle.tiltag.varmebesparelseGUF.unit' | trans }}</div>
    </div>
    <div class="row">
      <div class="col-xs-8">{{ 'appbundle.tiltag.anlaegsInvestering' | trans }}</div>
      <div class="col-xs-2 text-right">{{ section.tiltag.anlaegsinvestering | format_zeros }}</div>
      <div class="col-xs-2">{{ 'appbundle.tiltag.anlaegsInvestering.unit' | trans }}</div>
    </div>
    <div class="row">
      <div class="col-xs-8">{{ 'appbundle.tiltag.varmebesparelseGAF' | trans }}</div>
      <div class="col-xs-2 text-right">{{ section.tiltag.varmebesparelseGAF | format_zeros }}</div>
      <div class="col-xs-2">{{ 'appbundle.tiltag.varmebesparelseGAF.unit' | trans }}</div>
    </div>
    <div class="row">
      <div class="col-xs-8">{{ 'appbundle.tiltag.besparelseDriftOgVedligeholdelse' | trans }}</div>
      <div class="col-xs-2 text-right">{{ section.tiltag.besparelseDriftOgVedligeholdelse | format_zeros }}</div>
      <div class="col-xs-2">{{ 'appbundle.tiltag.besparelseDriftOgVedligeholdelse.unit' | trans }}</div>
    </div>
    <div class="row">
      <div class="col-xs-8">{{ 'appbundle.tiltag.elbesparelse' | trans }}</div>
      <div class="col-xs-2 text-right">{{ section.tiltag.elbesparelse | format_zeros }}</div>
      <div class="col-xs-2">{{ 'appbundle.tiltag.elbesparelse.unit' | trans }}</div>
    </div>
    <div class="row">
      <div class="col-xs-8">{{ 'appbundle.tiltag.besparelseStrafafkoelingsafgift' | trans }}</div>
      <div class="col-xs-2 text-right">{{ section.tiltag.besparelseStrafafkoelingsafgift | format_zeros }}</div>
      <div class="col-xs-2">{{ 'appbundle.tiltag.besparelseStrafafkoelingsafgift.unit' | trans }}</div>
    </div>
    {% if section.tiltag.salgTilNettetAar1 is defined %}
      <div class="row">
        <div class="col-xs-8">{{ 'appbundle.tiltag.salgTilNettetAar1' | trans }}</div>
        <div class="col-xs-2 text-right">{{ section.tiltag.salgTilNettetAar1 | format_zeros }}</div>
        <div class="col-xs-2">{{ 'appbundle.tiltag.salgTilNettetAar1.unit' | trans }}</div>
      </div>
    {% endif %}
    <div class="row">
      <div class="col-xs-8">{{ 'appbundle.tiltag.levetid' | trans }}</div>
      <div class="col-xs-2 text-right">{{ section.tiltag.levetid | format_zeros }}</div>
      <div class="col-xs-2">{{ 'appbundle.tiltag.levetid.unit' | trans }}</div>
    </div>
    <div class="row">
      <div class="col-xs-8">{{ 'appbundle.tiltag.besparelseAarEt' | trans }}</div>
      <div class="col-xs-2 text-right">{{ section.tiltag.besparelseAarEt | format_zeros }}</div>
      <div class="col-xs-2">{{ 'appbundle.tiltag.besparelseAarEt.unit' | trans }}</div>
    </div>
    <div class="row">
      <div class="col-xs-8">{{ 'appbundle.tiltag.simpelTilbagebetalingstidAar' | trans }}</div>
      <div class="col-xs-2 text-right">{{ section.tiltag.simpelTilbagebetalingstidAar | format_zeros }}</div>
      <div class="col-xs-2">{{ 'appbundle.tiltag.simpelTilbagebetalingstidAar.unit' | trans }}</div>
    </div>
    <div class="row">
      <div class="col-xs-8">{{ 'appbundle.tiltag.samletCo2besparelse' | trans }}</div>
      <div class="col-xs-2 text-right">{{ section.tiltag.samletCo2besparelse | format_decimal }}</div>
      <div class="col-xs-2">{{ 'appbundle.tiltag.samletCo2besparelse.unit' | trans }}</div>
    </div>
    <div class="row">
      <div class="col-xs-8">{{ 'appbundle.tiltag.nutidsvaerdiSetOver15AarKr' | trans }}</div>
      <div class="col-xs-2 text-right">{{ section.tiltag.nutidsvaerdiSetOver15AarKr | format_zeros }}</div>
      <div class="col-xs-2">{{ 'appbundle.tiltag.nutidsvaerdiSetOver15AarKr.unit' | trans }}</div>
    </div>
    <h3>Beskrivelse</h3>
    {% if section.tiltag.beskrivelseNuvaerende is not empty %}
      <div class="row">
        <div class="col-xs-4">Nuværende forhold</div>
        <div class="col-xs-8">{{ section.tiltag.beskrivelseNuvaerende }}</div>
      </div>
    {% endif %}
    {% if section.tiltag.beskrivelseForslag is not empty %}
      <div class="row">
        <div class="col-xs-4">Forslag</div>
        <div class="col-xs-8">{{ section.tiltag.beskrivelseForslag }}</div>
      </div>
    {% endif %}
    {% if section.tiltag.beskrivelseOevrige is not empty %}
      <div class="row">
        <div class="col-xs-4">Øvrige bemærkninger</div>
        <div class="col-xs-8">{{ section.tiltag.beskrivelseOevrige }}</div>
      </div>
    {% endif %}
    {% if section.tiltag.placering is not empty %}
      <div class="row">
        <div class="col-xs-4">Placering jf. oversigtstegning</div>
        <div class="col-xs-8">{{ section.tiltag.placering }}</div>
      </div>
    {% endif %}
    {% if section.tiltag.beskrivelseDriftOgVedligeholdelse is not empty %}
      <div class="row">
        <div class="col-xs-4">Beskrivelse af ændringer til D & V</div>
        <div class="col-xs-8">{{ section.tiltag.beskrivelseDriftOgVedligeholdelse }}</div>
      </div>
    {% endif %}
    {% if section.tiltag.indeklima is not empty %}
      <div class="row">
        <div class="col-xs-4">Indeklima/brugere</div>
        <div class="col-xs-8">{{ section.tiltag.indeklima }}</div>
      </div>
    {% endif %}
  </div>
  {% include 'AppBundle::RapportSektioner/_includes/section-page-break.html.twig' with { landscape : 1} %}
  <div class="section-tiltag-details">
    <h2>Detailarke</h2>
    {% if section.tiltag.tilvalgteDetails is not empty %}
      {% set template = 'AppBundle:' ~ tiltag_type(section.tiltag) ~ 'Tiltag:_detailTablePdf.html.twig' %}
      <div class="panel panel-default page-break-before">
        <div class="panel-heading"><h3 class="panel-title">Skema til: {{ section.tiltag.title }}</h3></div>
        {% include template with {'entity': section.tiltag} %}
      </div>
    {% else %}
      Ingen tilvalgte detailarke.
    {% endif %}

  </div>
{% endblock %}
