{% set barChartIdRandomized = 'samlet-forbrug-bar-' ~ random() %}
{% set doughnutIdRandomized = 'samlet-forbrug-pie-' ~ random() %}

<div class="row">
    <div class="col-xs-6">
        <canvas id="{{ barChartIdRandomized }}" style="height: 370px; width: 100%;"></canvas>
        <img src="" alt="" id="barchartimage">
    </div>
    <div class="col-xs-6">
        <div class="chart">
            <div class="chart-heading">
                <div class="chart-heading__title">{{ chart_data.reduction }}%</div>
                <div class="chart-heading__subtitle">
                    Energireduktion samlet
                </div>
            </div>

            <canvas id="{{ doughnutIdRandomized }}" width="300" height="300"></canvas>
        </div>
    </div>
</div>

<script>
    // Bar.
    (function () {
        {#var dataCollection = {{ chart_data | json_encode | raw }};#}
        {#var options = {#}
        {#    scaleBeginAtZero: true,#}
        {#    scaleShowGridLines: true,#}
        {#};#}
        {#var data = {#}
        {#    labels: ['Nuv√¶rende', 'Optimeret'],#}
        {#    datasets: [#}
        {#        {#}
        {#            data: [dataCollection.nuvaerende, dataCollection.optimeret],#}
        {#            fillColor: '#62c5d3',#}
        {#        },#}
        {#    ]#}
        {#};#}
        {#var ctx = document.getElementById('{{ barChartIdRandomized }}').getContext('2d');#}
        {#var bar = new Chart(ctx).Bar(data, options);#}

        var options = {
            bezierCurve : false,
            animation: {
                onComplete: function() {
                    var image = myBarChart.toBase64Image();
                    var imageNode = document.getElementById('barchartimage');
                    imageNode.src = image;
                    console.log(myBarChart.toBase64Image());
                }
            }
        };
        var data = {
            datasets: [{
                barPercentage: 0.5,
                barThickness: 6,
                maxBarThickness: 8,
                minBarLength: 2,
                data: [10, 20, 30, 40, 50, 60, 70]
            }]
        };
        var ctx = document.getElementById('{{ barChartIdRandomized }}').getContext('2d');
        var myBarChart = new Chart(ctx, {
            type: 'bar',
            data: data,
            options: options,
        });
        debugger;
    }());

    // Doughnut.
    (function () {
        {#var dataCollection = {{ chart_data | json_encode | raw }};#}
        {#var options = {#}
        {#    animation: false,#}
        {#    segmentShowStroke: false,#}
        {#    percentageInnerCutout: 75,#}
        {#};#}
        {#var data = [#}
        {#    {#}
        {#        value: dataCollection.reduction,#}
        {#        color: '#62c5d3',#}
        {#    },#}
        {#    {#}
        {#        value: (100 - dataCollection.reduction),#}
        {#        color: '#f2f2f0',#}
        {#    },#}
        {#];#}
        {#var ctx = document.getElementById('{{ doughnutIdRandomized }}').getContext('2d');#}
        {#var doughnut = new Chart(ctx).Doughnut(data, options);#}
    }());
</script>
